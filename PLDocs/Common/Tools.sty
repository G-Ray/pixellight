%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% tools.sty                                      %
%                                                %
% by Stefan Buschmann                            %
% 2003-09-26                                     %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% timestamp                                      %
%                                                %
% prints the current date and time               %
% ---------------------------------------------- %
% usage: \timestamp                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcount\hr \newcount\mn
\hr=\time    \mn=\hr
\divide\hr by 60
\loop\ifnum\mn>59\advance\mn by -60\repeat

\def\timestamp{
  \number\year-%
  \ifnum\month<10 0\fi\number\month-%
  \ifnum\day  <10 0\fi\number\day, 
  \ifnum\hr   <10 0\fi\number\hr:%
  \ifnum\mn   <10 0\fi\number\mn}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% printdate                                      %
%                                                %
% prints the current date in YY-MM-DD            %
% ---------------------------------------------- %
% usage: \printdate                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\printdate{
  \number\year-%
  \ifnum\month<10 0\fi\number\month-%
  \ifnum\day  <10 0\fi\number\day}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% printtime                                      %
%                                                %
% prints the current time in HH:MM               %
% ---------------------------------------------- %
% usage: \printtime                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\printtime{
  \ifnum\hr   <10 0\fi\number\hr:%
  \ifnum\mn   <10 0\fi\number\mn}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% printuline                                     %
%                                                %
% environment for printing '_' as a character    %
% ---------------------------------------------- %
% usage: \begin{printuline} ... \end{printuline} %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newenvironment{printuline}{\catcode`\_=11}{\catcode`\_=8}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% advbox                                         %
%                                                %
% advanced box environment that can handle       %
% paragraphs as well a verbatim text             %
% ---------------------------------------------- %
% usage: \begin{advbox}[width]                   %
%   [width] width of box                         %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newsavebox{\advbbox}
\newenvironment{advbox}[1][\columnwidth]
  {\begin{lrbox}{\advbbox}\begin{minipage}{#1}}
  {\end{minipage}\end{lrbox}\fbox{\usebox{\advbbox}}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% cadvbox                                        %
%                                                %
% advanced colored box environment               %
% ---------------------------------------------- %
% usage: \begin{cadvbox}[width]{border}{back}    %
%   [width]   width of box                       %
%   {border}  border color                       %
%   {back}    background color                   %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newenvironment{cadvbox}[3][\columnwidth]
  {\def\cadvboxtcol{#2}\def\cadvboxbcol{#3}\begin{lrbox}{\advbbox}\begin{minipage}{#1}}
  {\end{minipage}\end{lrbox}\fcolorbox{\cadvboxtcol}{\cadvboxbcol}{\usebox{\advbbox}}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% NOTE                                           %
%                                                %
% displays a note-box                            %
% ---------------------------------------------- %
% usage: \begin{NOTE} ... \end{NOTE}             %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\NOTEprefix{\textbf{Note: }}
\newenvironment{NOTE}[1][]
  {\begin{cadvbox}{NOTEframe}{NOTEback}\NOTEprefix #1 \\}
  {\end{cadvbox}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% CODE                                           %
%                                                %
% displays a code-box                            %
% ---------------------------------------------- %
% usage: \begin{CODE} ... \end{CODE}             %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\CODEprefix{}
\newenvironment{CODE}[1][]
  {\VerbatimEnvironment\begin{cadvbox}{CODEframe}{CODEback}\CODEprefix #1 \begin{Verbatim}}
  {\end{Verbatim}\end{cadvbox}}
